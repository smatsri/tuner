<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Audio Visualizer</title>
  </head>
  <body>
    <canvas id="visualizer" width="800" height="200"></canvas>
    <button id="playBtn">Play/Pause</button>

    <script src="./scripts/audio-visualizer.js"></script>
    <script>
      async function init() {
        const visualizer = new AudioVisualizer();
        const playBtn = document.getElementById("playBtn");
        let video;

        // Wait for user interaction to initialize audio
        playBtn.onclick = async () => {
          if (!video) {
            // First click - initialize everything
            try {
              video = await visualizer.loadVideo("./audio/standard-tuning.mp4");
              document.body.appendChild(video);
              video.style.display = "none";

              const canvas = document.getElementById("visualizer");
              visualizer.draw(canvas);
            } catch (error) {
              console.error("Failed to initialize audio visualizer:", error);
              return;
            }
          }

          // Toggle play/pause
          if (video.paused) {
            video.play();
          } else {
            video.pause();
          }
        };
      }

      init();
    </script>
  </body>
</html>
